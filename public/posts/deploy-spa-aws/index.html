<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Deploy a Single Page Application (SPA) to AWS | JakobTheDev | Jakob Pennington</title><meta name=keywords content="AWS,Cloud,CI / CD Pipelines,Software Development"><meta name=description content="Recently, I made a simple personal website ‚Äî a hub for my online presences and a place to share my personal projects. I developed the site using the Angular CLI, and when it came time to host the site, I chose AWS since my domain was already set up in Route 53. Overall, the process of building the application and hosting it on AWS was a fairly simple one (you could probably set the whole thing up in about an hour), but there were a couple of gotchyas that prompted me to write down the process."><meta name=author content="Jakob Pennington"><link rel=canonical href=https://www.jakobthe.dev/posts/deploy-spa-aws/><meta name=google-site-verification content="G-29MNLJYDQX"><link crossorigin=anonymous href=/assets/css/stylesheet.3299c596a7007118365635c056dd427dace22b7b8c1341fdef6fa6c31359ba10.css integrity="sha256-MpnFlqcAcRg2VjXAVt1CfaziK3uME0H972+mwxNZuhA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.jakobthe.dev/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.jakobthe.dev/images/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.jakobthe.dev/images/favicon-32x32.png><link rel=apple-touch-icon href=https://www.jakobthe.dev/images/apple-touch-icon.png><link rel=mask-icon href=https://www.jakobthe.dev/images/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-29MNLJYDQX"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-29MNLJYDQX",{anonymize_ip:!1})}</script><meta property="og:title" content="Deploy a Single Page Application (SPA) to AWS"><meta property="og:description" content="Recently, I made a simple personal website ‚Äî a hub for my online presences and a place to share my personal projects. I developed the site using the Angular CLI, and when it came time to host the site, I chose AWS since my domain was already set up in Route 53. Overall, the process of building the application and hosting it on AWS was a fairly simple one (you could probably set the whole thing up in about an hour), but there were a couple of gotchyas that prompted me to write down the process."><meta property="og:type" content="article"><meta property="og:url" content="https://www.jakobthe.dev/posts/deploy-spa-aws/"><meta property="og:image" content="https://www.jakobthe.dev/posts/deploy-spa-aws/angular-aws.webp"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-07-17T15:45:00+10:30"><meta property="article:modified_time" content="2018-07-17T15:45:00+10:30"><meta property="og:site_name" content="JakobTheDev"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.jakobthe.dev/posts/deploy-spa-aws/angular-aws.webp"><meta name=twitter:title content="Deploy a Single Page Application (SPA) to AWS"><meta name=twitter:description content="Recently, I made a simple personal website ‚Äî a hub for my online presences and a place to share my personal projects. I developed the site using the Angular CLI, and when it came time to host the site, I chose AWS since my domain was already set up in Route 53. Overall, the process of building the application and hosting it on AWS was a fairly simple one (you could probably set the whole thing up in about an hour), but there were a couple of gotchyas that prompted me to write down the process."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.jakobthe.dev/posts/"},{"@type":"ListItem","position":2,"name":"Deploy a Single Page Application (SPA) to AWS","item":"https://www.jakobthe.dev/posts/deploy-spa-aws/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Deploy a Single Page Application (SPA) to AWS","name":"Deploy a Single Page Application (SPA) to AWS","description":"Recently, I made a simple personal website ‚Äî a hub for my online presences and a place to share my personal projects. I developed the site using the Angular CLI, and when it came time to host the site, I chose AWS since my domain was already set up in Route 53. Overall, the process of building the application and hosting it on AWS was a fairly simple one (you could probably set the whole thing up in about an hour), but there were a couple of gotchyas that prompted me to write down the process.","keywords":["AWS","Cloud","CI / CD Pipelines","Software Development"],"articleBody":"Recently, I made a simple personal website ‚Äî a hub for my online presences and a place to share my personal projects. I developed the site using the Angular CLI, and when it came time to host the site, I chose AWS since my domain was already set up in Route 53. Overall, the process of building the application and hosting it on AWS was a fairly simple one (you could probably set the whole thing up in about an hour), but there were a couple of gotchyas that prompted me to write down the process. So I figured, why not save somebody the hassle of working out the nitty gritties! Here‚Äôs my step-by-step guide to setting up a SPA in AWS.\nTime: 1hr Upfront cost: $0 Ongoing cost: Very little, depends on how popular your site is! What do we want to achieve? The simplest way to host your site is to upload your code to an S3 bucket and share the default URL. This might save you a few minutes in hosting the site, but it‚Äôs not ideal‚Ä¶ The URL will look something like http://jakob.pennington.io.s3-website-ap-southeast-2.amazonaws.com (Good luck getting Grandma to type that in). Also, the site will only be available over an insecure HTTP connection. Sensitive information or not, every website you ever make should be hosted exclusively over HTTPS. Spend 5 minutes on @TroyHunt‚Äôs Twitter to learn all the reasons why. Finally, if somebody clicks a link like http://jakob.pennington.io/duckies, or even refreshes the page, they won‚Äôt be greeted with adorable fluffy waterfowl, but rather an error page. This is because, in a SPA, the application handles routing, and S3 is a little dumb and will try to find a file called ‚Äòduckies‚Äô.\nSo in addition to hosting the site, we want to:\nSet up our own domain name, Set up SSL, and redirect all HTTP traffic to HTTPS, and Hand all requests to the root of the site, so Angular can handle routing. To do this, we‚Äôre going to use the following AWS services:\nS3 ‚Äî Since our application is static, we can host the files in an S3 bucket. Certificate Manager ‚Äî Get a free SSL Certificate for HTTPS. CloudFront ‚Äî Primarily to provide HTTPS, we‚Äôll set up a CloudFront distribution for our site. Route 53 ‚Äî Finally, we‚Äôll set up Route 53 to point to our CloudFront distribution. All in all, we‚Äôll end up with something like this:\nThe AWS architecture we‚Äôll be using.\nBuild the site This part is really dependent on how you‚Äôve created your site. Since I build my web application with the Angular CLI, building the production site was easy:\nng build --prod If you built your site with something else, that‚Äôs cool too! I‚Äôll leave it to you to build the production codebase, since out of you and I, you‚Äôre probably the expert there üòâ\nSet up a domain in Route 53 Register a domain\nGo get yourself a domain, if you haven‚Äôt already. Check out Hover or GoDaddy or if you‚Äôre feeling adventurous, grab yourself an emoji domain from i‚ù§Ô∏è.ws.\nCreate a Hosted Zone in AWS\nLog into the AWS Console and head to the Route 53 page. Create a new hosted zone, enter your domain (eg. pennington.io) and leave the type as Public Hosted Zone.\nChange registrar DNS\nWe want to let Route 53 handle DNS. In your domain management page on your registrar‚Äôs website, set the DNS servers to the values in the NS record in the Hosted Zone you created in Route 53.\nWe‚Äôll come back at the end to set up the records to point at your site.\nHost the site in S3 Create a bucket\nIn the AWS Console, head to the S3 page and create a new bucket. Be sure to give the bucket the same name as the FQDN of where the site will be hosted. For me, I created a bucket called jakob.pennington.io. When you get to the Set Permissions step, set Manage public permissions to Grant public read access to this bucket.\nUpload files\nOnce the bucket has been created, open up the bucket and copy in the built website. Make sure you copy everything, including your index.html, favicon, JS, CSS and any images.\nTurn on static website hosting\nHead to the properties tab and select static website hosting. Set both the index and error documents to index.html to tell S3 where the root of the web application lies. This won‚Äôt matter so much once CloudFront is set up, but we might as well set them while we‚Äôre here.\nConfigure the bucket policy\nHead to the Permissions tab, then Bucket Policy, and copy in the following policy. This policy allows the public to read objects from the bucket (So don‚Äôt put any secrets or sensitive information in here). Be sure to replace the Resource ARN to your own, it should be displayed on the Bucket Policy page.\n{ \"Version\": \"2012-10-17\", \"Statement\": [ { \"Sid\": \"PublicReadGetObject\", \"Effect\": \"Allow\", \"Principal\": \"*\", \"Action\": \"s3:GetObject\", \"Resource\": \"arn:aws:s3:::jakob.pennington.io/*\" } ] } At this point, you should be able to access your site. Go back to Properties \u003e Static website hosting to get the URL of your website.\nGet an SSL Certificate Next, we need to generate a certificate using AWS Certificate Manager. Head to ACM in the console and provision a new public certificate. Set the domain name to either the FQDN (jakob.pennington.io) or create a wildcard certificate (*.pennington.io). Select DNS Validation and confirm the request. In the final step, expand the domain you created and click Create record in Route 53. This creates a record in Route 53 to verify that you own the domain, which can take up to 30 minutes.\nSet up CloudFront distribution Next, we‚Äôll set up CloudFront as a CDN for our site. This will let us configure HTTPS while improving the performance of our site as a bonus!\nCreate the distribution\nGo to CloudFront in the AWS Console and create a new web distribution. This is the most config-heavy part of the process, so set the following values and leave the rest as defaults:\nOrigin Domain Name: Select your S3 bucket from the drop-down list. Viewer Protocol Policy: Redirect HTTP to HTTPS SSL Certificate: Custom SSL Certificate. Here, select the certificate you created with ACM. Security Policy: Select TLSv1.1_2016 or TLSv1.2_2018. Default Root Object: index.html Set up redirects to index.html\nOnce the distribution is created, open the distribution and head to the Error Pages tab. Here set up two custom error responses ‚Äî one for 403 Forbidden and one for 404 Not Found.\nHTTP Error Code: 403 / 404 Error Caching Minimum TTL (seconds): 0 Customize Error Response: Yes Response Page Path: /index.html HTTP Response Code: 200: OK What this does is redirects all error responses to index.html, effectively letting the SPA handle routing.\nSet up a DNS record The last step is to set up a DNS record in Route 53 to point at the CloudFront distribution. To do this, we will create an A Record, which is a type of DNS record that lets the browser resolve a domain name (jakob.pennington.io) to an IP address (123.123.123.123). Head to Route 53, select your Hosted Zone, and create a new Record Set with the following settings:\nName: The subdomain you want to use (eg. www, the part before your domain name). This needs to match the subdomain you set in S3, CloudFront and Certificate Manager) Type: A ‚Äî IPv4 address Alias: Yes Alias Target: Select your CloudFront distribution from the drop-down list. That‚Äôs it! if you navigate to your chosen URL you should see your site. Check that HTTPS is set up and HTTP redirects to HTTPS. While you‚Äôre at it, go check out mine too! I‚Äôll be adding new content over the coming weeks and months.\nhttps://jakob.pennington.io/\nIf you have any comments on my site or something you‚Äôd like to see in a future post, leave them below üòä\nA note on CloudFront caching One final bit. CloudFront, as a CDN, stores copies of your website all over the world to make your site faster to access. The problem is, if you make a change to your site, it can take some time for the changes to propagate. You can force this to happen faster by invalidating the files in the distribution:\nGo to CloudFront and select your distribution. Head to the Invalidations tab. Create an Invalidation, and set the Object Path to: /* Thanks for reading!\nIf you enjoyed this post, follow on Twitter or Mastodon for more content. If you have any feedback or suggestions, leave it in the comments below and I‚Äôll do my best to get back to you.\n","wordCount":"1445","inLanguage":"en","image":"https://www.jakobthe.dev/posts/deploy-spa-aws/angular-aws.webp","datePublished":"2018-07-17T15:45:00+10:30","dateModified":"2018-07-17T15:45:00+10:30","author":{"@type":"Person","name":"Jakob Pennington"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.jakobthe.dev/posts/deploy-spa-aws/"},"publisher":{"@type":"Organization","name":"JakobTheDev | Jakob Pennington","logo":{"@type":"ImageObject","url":"https://www.jakobthe.dev/images/favicon.ico"}}}</script><a rel=me style=display:none href=https://infosec.exchange/@JakobTheDev>Mastodon</a></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.jakobthe.dev/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.jakobthe.dev/about title=About><span>About</span></a></li><li><a href=https://www.jakobthe.dev/posts/ title=Blog><span>Blog</span></a></li><li><a href=https://www.jakobthe.dev/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://www.jakobthe.dev/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.jakobthe.dev/>Home</a>&nbsp;¬ª&nbsp;<a href=https://www.jakobthe.dev/posts/>Posts</a></div><h1 class=post-title>Deploy a Single Page Application (SPA) to AWS</h1><div class=post-meta><span title='2018-07-17 15:45:00 +1030 +1030'>17 July 2018</span>&nbsp;¬∑&nbsp;7 min&nbsp;¬∑&nbsp;1445 words&nbsp;¬∑&nbsp;Jakob Pennington&nbsp;|&nbsp;<a href=https://github.com/JakobTheDev/website/content/posts/2-deploy-spa-aws/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><a href=https://www.jakobthe.dev/posts/deploy-spa-aws/angular-aws.webp target=_blank rel="noopener noreferrer"><img loading=lazy srcset="https://www.jakobthe.dev/posts/deploy-spa-aws/angular-aws_hu11df95cb43b9bd528cdc8cd697a3081b_10358_360x0_resize_q75_h2_box_2.webp 360w ,https://www.jakobthe.dev/posts/deploy-spa-aws/angular-aws_hu11df95cb43b9bd528cdc8cd697a3081b_10358_480x0_resize_q75_h2_box_2.webp 480w ,https://www.jakobthe.dev/posts/deploy-spa-aws/angular-aws_hu11df95cb43b9bd528cdc8cd697a3081b_10358_720x0_resize_q75_h2_box_2.webp 720w ,https://www.jakobthe.dev/posts/deploy-spa-aws/angular-aws_hu11df95cb43b9bd528cdc8cd697a3081b_10358_1080x0_resize_q75_h2_box_2.webp 1080w ,https://www.jakobthe.dev/posts/deploy-spa-aws/angular-aws.webp 1280w" sizes="(min-width: 768px) 720px, 100vw" src=https://www.jakobthe.dev/posts/deploy-spa-aws/angular-aws.webp alt="A graphic showing the Angular, AWS CloudFront, AWS Route 53 and AWS S3 logos." width=1280 height=567></a></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#what-do-we-want-to-achieve>What do we want to achieve?</a></li><li><a href=#build-the-site>Build the site</a></li><li><a href=#set-up-a-domain-in-route-53>Set up a domain in Route 53</a></li><li><a href=#host-the-site-in-s3>Host the site in S3</a></li><li><a href=#get-an-ssl-certificate>Get an SSL Certificate</a></li><li><a href=#set-up-cloudfront-distribution>Set up CloudFront distribution</a></li><li><a href=#set-up-a-dns-record>Set up a DNS record</a></li><li><a href=#a-note-on-cloudfront-caching>A note on CloudFront caching</a></li></ul></nav></div></details></div><div class=post-content><p>Recently, I made a simple personal website ‚Äî a hub for my online presences and a place to share my personal projects. I developed the site using the Angular CLI, and when it came time to host the site, I chose AWS since my domain was already set up in Route 53. Overall, the process of building the application and hosting it on AWS was a fairly simple one (you could probably set the whole thing up in about an hour), but there were a couple of gotchyas that prompted me to write down the process. So I figured, why not save somebody the hassle of working out the nitty gritties! Here‚Äôs my step-by-step guide to setting up a SPA in AWS.</p><ul><li><strong>Time:</strong> 1hr</li><li><strong>Upfront cost:</strong> $0</li><li><strong>Ongoing cost:</strong> Very little, depends on how popular your site is!</li></ul><h2 id=what-do-we-want-to-achieve>What do we want to achieve?<a hidden class=anchor aria-hidden=true href=#what-do-we-want-to-achieve>#</a></h2><p>The simplest way to host your site is to upload your code to an S3 bucket and share the default URL. This might save you a few minutes in hosting the site, but it‚Äôs not ideal‚Ä¶ The URL will look something like <code>http://jakob.pennington.io.s3-website-ap-southeast-2.amazonaws.com</code> (Good luck getting Grandma to type that in). Also, the site will only be available over an insecure HTTP connection. Sensitive information or not, every website you ever make should be hosted exclusively over HTTPS. Spend 5 minutes on <a href=https://twitter.com/troyhunt>@TroyHunt</a>&rsquo;s Twitter to learn all the reasons why. Finally, if somebody clicks a link like <code>http://jakob.pennington.io/duckies</code>, or even refreshes the page, they won&rsquo;t be greeted with adorable fluffy waterfowl, but rather an error page. This is because, in a SPA, the application handles routing, and S3 is a little dumb and will try to find a file called &lsquo;duckies&rsquo;.</p><p>So in addition to hosting the site, we want to:</p><ul><li>Set up our own domain name,</li><li>Set up SSL, and redirect all HTTP traffic to HTTPS, and</li><li>Hand all requests to the root of the site, so Angular can handle routing.</li></ul><p>To do this, we‚Äôre going to use the following AWS services:</p><ul><li><strong>S3</strong> ‚Äî Since our application is static, we can host the files in an S3 bucket.</li><li><strong>Certificate Manager</strong> ‚Äî Get a free SSL Certificate for HTTPS.</li><li><strong>CloudFront</strong> ‚Äî Primarily to provide HTTPS, we‚Äôll set up a CloudFront distribution for our site.</li><li><strong>Route 53</strong> ‚Äî Finally, we‚Äôll set up Route 53 to point to our CloudFront distribution.</li></ul><p>All in all, we‚Äôll end up with something like this:</p><p><img loading=lazy src=aws-architecture.webp alt="AWS Architecture diagram, showing the relationships between the user, AWS Route 53, AWS CloudFront and AWS S3">
<em>The AWS architecture we&rsquo;ll be using.</em></p><h2 id=build-the-site>Build the site<a hidden class=anchor aria-hidden=true href=#build-the-site>#</a></h2><p>This part is really dependent on how you‚Äôve created your site. Since I build my web application with the Angular CLI, building the production site was easy:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ng build --prod
</span></span></code></pre></div><p>If you built your site with something else, that‚Äôs cool too! I‚Äôll leave it to you to build the production codebase, since out of you and I, you‚Äôre probably the expert there üòâ</p><h2 id=set-up-a-domain-in-route-53>Set up a domain in Route 53<a hidden class=anchor aria-hidden=true href=#set-up-a-domain-in-route-53>#</a></h2><ol><li><p><strong>Register a domain</strong><br>Go get yourself a domain, if you haven‚Äôt already. Check out <a href=https://www.hover.com/>Hover</a> or <a href=https://au.godaddy.com/>GoDaddy</a> or if you‚Äôre feeling adventurous, grab yourself an emoji domain from <a href=https://xn--i-7iq.ws/>i‚ù§Ô∏è.ws</a>.</p></li><li><p><strong>Create a Hosted Zone in AWS</strong><br>Log into the <a href=https://console.aws.amazon.com/>AWS Console</a> and head to the Route 53 page. Create a new hosted zone, enter your domain (eg. <em>pennington.io</em>) and leave the type as Public Hosted Zone.</p></li><li><p><strong>Change registrar DNS</strong><br>We want to let Route 53 handle DNS. In your domain management page on your registrar‚Äôs website, set the DNS servers to the values in the NS record in the Hosted Zone you created in Route 53.</p></li></ol><p>We‚Äôll come back at the end to set up the records to point at your site.</p><h2 id=host-the-site-in-s3>Host the site in S3<a hidden class=anchor aria-hidden=true href=#host-the-site-in-s3>#</a></h2><ol><li><p><strong>Create a bucket</strong><br>In the AWS Console, head to the S3 page and create a new bucket. Be sure to give the bucket the same name as the FQDN of where the site will be hosted. For me, I created a bucket called <code>jakob.pennington.io</code>. When you get to the <em>Set Permissions</em> step, set <em>Manage public permissions</em> to <em>Grant public read access to this bucket</em>.</p></li><li><p><strong>Upload files</strong><br>Once the bucket has been created, open up the bucket and copy in the built website. Make sure you copy everything, including your index.html, favicon, JS, CSS and any images.</p></li><li><p><strong>Turn on static website hosting</strong><br>Head to the properties tab and select static website hosting. Set both the index and error documents to index.html to tell S3 where the root of the web application lies. This won‚Äôt matter so much once CloudFront is set up, but we might as well set them while we‚Äôre here.</p></li><li><p><strong>Configure the bucket policy</strong><br>Head to the Permissions tab, then Bucket Policy, and copy in the following policy. This policy allows the public to read objects from the bucket (So don‚Äôt put any secrets or sensitive information in here). Be sure to replace the Resource ARN to your own, it should be displayed on the Bucket Policy page.</p></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span> <span class=nt>&#34;Version&#34;</span><span class=p>:</span> <span class=s2>&#34;2012-10-17&#34;</span><span class=p>,</span> <span class=nt>&#34;Statement&#34;</span><span class=p>:</span> <span class=p>[</span> <span class=p>{</span> <span class=nt>&#34;Sid&#34;</span><span class=p>:</span> <span class=s2>&#34;PublicReadGetObject&#34;</span><span class=p>,</span> <span class=nt>&#34;Effect&#34;</span><span class=p>:</span> <span class=s2>&#34;Allow&#34;</span><span class=p>,</span> <span class=nt>&#34;Principal&#34;</span><span class=p>:</span> <span class=s2>&#34;*&#34;</span><span class=p>,</span> <span class=nt>&#34;Action&#34;</span><span class=p>:</span> <span class=s2>&#34;s3:GetObject&#34;</span><span class=p>,</span> <span class=nt>&#34;Resource&#34;</span><span class=p>:</span> <span class=s2>&#34;arn:aws:s3:::jakob.pennington.io/*&#34;</span> <span class=p>}</span> <span class=p>]</span> <span class=p>}</span>
</span></span></code></pre></div><p>At this point, you should be able to access your site. Go back to Properties > Static website hosting to get the URL of your website.</p><h2 id=get-an-ssl-certificate>Get an SSL Certificate<a hidden class=anchor aria-hidden=true href=#get-an-ssl-certificate>#</a></h2><p>Next, we need to generate a certificate using AWS Certificate Manager. Head to ACM in the console and provision a new public certificate. Set the domain name to either the FQDN (jakob.pennington.io) or create a wildcard certificate (*.pennington.io). Select <em>DNS Validation</em> and confirm the request. In the final step, expand the domain you created and click <em>Create record in Route 53</em>. This creates a record in Route 53 to verify that you own the domain, which can take up to 30 minutes.</p><h2 id=set-up-cloudfront-distribution>Set up CloudFront distribution<a hidden class=anchor aria-hidden=true href=#set-up-cloudfront-distribution>#</a></h2><p>Next, we‚Äôll set up CloudFront as a CDN for our site. This will let us configure HTTPS while improving the performance of our site as a bonus!</p><ol><li><p><strong>Create the distribution</strong><br>Go to CloudFront in the AWS Console and create a new web distribution. This is the most config-heavy part of the process, so set the following values and leave the rest as defaults:</p><ul><li><strong>Origin Domain Name:</strong> Select your S3 bucket from the drop-down list.</li><li><strong>Viewer Protocol Policy:</strong> Redirect HTTP to HTTPS</li><li><strong>SSL Certificate:</strong> Custom SSL Certificate. Here, select the certificate you created with ACM.</li><li><strong>Security Policy:</strong> Select TLSv1.1_2016 or TLSv1.2_2018.</li><li><strong>Default Root Object:</strong> index.html</li></ul></li><li><p><strong>Set up redirects to index.html</strong><br>Once the distribution is created, open the distribution and head to the Error Pages tab. Here set up two custom error responses ‚Äî one for 403 Forbidden and one for 404 Not Found.</p><ul><li><strong>HTTP Error Code:</strong> 403 / 404</li><li><strong>Error Caching Minimum TTL (seconds):</strong> 0</li><li><strong>Customize Error Response:</strong> Yes</li><li><strong>Response Page Path:</strong> /index.html</li><li><strong>HTTP Response Code:</strong> 200: OK</li></ul></li></ol><p>What this does is redirects all error responses to index.html, effectively letting the SPA handle routing.</p><h2 id=set-up-a-dns-record>Set up a DNS record<a hidden class=anchor aria-hidden=true href=#set-up-a-dns-record>#</a></h2><p>The last step is to set up a DNS record in Route 53 to point at the CloudFront distribution. To do this, we will create an A Record, which is a type of DNS record that lets the browser resolve a domain name (jakob.pennington.io) to an IP address (123.123.123.123). Head to Route 53, select your Hosted Zone, and create a new Record Set with the following settings:</p><ul><li><strong>Name:</strong> The subdomain you want to use (eg. www, the part before your domain name). This needs to match the subdomain you set in S3, CloudFront and Certificate Manager)</li><li><strong>Type:</strong> A ‚Äî IPv4 address</li><li><strong>Alias:</strong> Yes</li><li><strong>Alias Target:</strong> Select your CloudFront distribution from the drop-down list.</li></ul><p>That‚Äôs it! if you navigate to your chosen URL you should see your site. Check that HTTPS is set up and HTTP redirects to HTTPS. While you‚Äôre at it, go check out mine too! I‚Äôll be adding new content over the coming weeks and months.</p><p><a href=https://jakob.pennington.io/>https://jakob.pennington.io/</a></p><p>If you have any comments on my site or something you‚Äôd like to see in a future post, leave them below üòä</p><h2 id=a-note-on-cloudfront-caching>A note on CloudFront caching<a hidden class=anchor aria-hidden=true href=#a-note-on-cloudfront-caching>#</a></h2><p>One final bit. CloudFront, as a CDN, stores copies of your website all over the world to make your site faster to access. The problem is, if you make a change to your site, it can take some time for the changes to propagate. You can force this to happen faster by invalidating the files in the distribution:</p><ol><li>Go to CloudFront and select your distribution.</li><li>Head to the Invalidations tab.</li><li>Create an Invalidation, and set the Object Path to: /*</li></ol><hr><p><strong>Thanks for reading!</strong><br>If you enjoyed this post, follow on <a href=https://www.twitter.com/@JakobTheDev>Twitter</a> or <a href=https://infosec.exchange/@JakobTheDev>Mastodon</a> for more content. If you have any feedback or suggestions, leave it in the comments below and I&rsquo;ll do my best to get back to you.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.jakobthe.dev/tags/aws/>AWS</a></li><li><a href=https://www.jakobthe.dev/tags/cloud/>Cloud</a></li><li><a href=https://www.jakobthe.dev/tags/ci-/-cd-pipelines/>CI / CD Pipelines</a></li><li><a href=https://www.jakobthe.dev/tags/software-development/>Software Development</a></li></ul><nav class=paginav><a class=prev href=https://www.jakobthe.dev/posts/aws-codepipeline/><span class=title>¬´ Prev</span><br><span>Automated Build / Deploy with AWS CodePipeline</span></a>
<a class=next href=https://www.jakobthe.dev/posts/minifying-xss/><span class=title>Next ¬ª</span><br><span>Minifying XSS</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Deploy a Single Page Application (SPA) to AWS on twitter" href="https://twitter.com/intent/tweet/?text=Deploy%20a%20Single%20Page%20Application%20%28SPA%29%20to%20AWS&url=https%3a%2f%2fwww.jakobthe.dev%2fposts%2fdeploy-spa-aws%2f&hashtags=AWS%2cCloud%2cCI%2fCDPipelines%2cSoftwareDevelopment"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Deploy a Single Page Application (SPA) to AWS on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fwww.jakobthe.dev%2fposts%2fdeploy-spa-aws%2f&title=Deploy%20a%20Single%20Page%20Application%20%28SPA%29%20to%20AWS&summary=Deploy%20a%20Single%20Page%20Application%20%28SPA%29%20to%20AWS&source=https%3a%2f%2fwww.jakobthe.dev%2fposts%2fdeploy-spa-aws%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Deploy a Single Page Application (SPA) to AWS on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.jakobthe.dev%2fposts%2fdeploy-spa-aws%2f&title=Deploy%20a%20Single%20Page%20Application%20%28SPA%29%20to%20AWS"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Deploy a Single Page Application (SPA) to AWS on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.jakobthe.dev%2fposts%2fdeploy-spa-aws%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Deploy a Single Page Application (SPA) to AWS on whatsapp" href="https://api.whatsapp.com/send?text=Deploy%20a%20Single%20Page%20Application%20%28SPA%29%20to%20AWS%20-%20https%3a%2f%2fwww.jakobthe.dev%2fposts%2fdeploy-spa-aws%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Deploy a Single Page Application (SPA) to AWS on telegram" href="https://telegram.me/share/url?text=Deploy%20a%20Single%20Page%20Application%20%28SPA%29%20to%20AWS&url=https%3a%2f%2fwww.jakobthe.dev%2fposts%2fdeploy-spa-aws%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//JakobTheDev.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2022 <a href=https://www.jakobthe.dev/>JakobTheDev | Jakob Pennington</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>